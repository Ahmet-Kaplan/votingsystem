<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                template="${'innerPage'.equals(param['mode'])? '/WEB-INF/templates/innervs.xhtml' :
                ('simplePage'.equals(param['mode']) ? '/WEB-INF/templates/simplevs.xhtml':'/WEB-INF/templates/toolbarvs.xhtml')}">
    <ui:define name="title">${msg.electionSystemLbl}</ui:define>
    <ui:define name="head">
        <link href="${resourceURL}/jsoneditor/jsoneditor.min.css" media="all" rel="stylesheet" />
        <script src="${resourceURL}/jsoneditor/jsoneditor.min.js" type="text/javascript"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
    </ui:define>
    <ui:define name="content">
        <div layout="" flex="" horizontal="" wrap="" around-justified="">
            <div layout="" vertical="">
                <div layout="" horizontal="" center="" center-justified="">
                    <paper-button raised="" onclick="validateCert()" style="margin: 0px 0px 0px 5px;">
                        ${msg.validateCertLbl}
                    </paper-button>
                    ${msg.operationForAdminSystemLbl}
                </div>
                <div id="validateCert" style="width: 500px; height: 300px;"></div>
            </div>
        </div>

        <script>
            var signedContent

            var validateCertEditor = new JSONEditor(document.querySelector("#validateCert"));
            var jsonValidateCert = {
                receiverName:"${config.serverName}",
                signedMessageSubject:"${msg.validateCertLbl}",
                signedContent:{nif:"", deviceId: ""},
                serviceURL:"${restURL}/csr/validate",
                serverURL:"${contextURL}",
                timeStampServerURL:"${config.timeStampServerURL}",
            }
            validateCertEditor.set(jsonValidateCert);

            function validateCert() {
                console.log("publishControlCenter")
                var webAppMessage = validateCertEditor.get();
                webAppMessage.statusCode = ResponseVS.SC_PROCESSING
                webAppMessage.objectId = Math.random().toString(36).substring(7)
                window[webAppMessage.objectId] = function(appMessage) {
                    console.log("publishControlCenter - message: " + appMessage);
                    var appMessageJSON = toJSON(appMessage)
                    showMessageVS(appMessageJSON.message, "validateCert - status: " + appMessageJSON.statusCode)
                }
                VotingSystemClient.setJSONMessageToSignatureClient(webAppMessage);
            }
        </script>

    </ui:define>
</ui:composition>
