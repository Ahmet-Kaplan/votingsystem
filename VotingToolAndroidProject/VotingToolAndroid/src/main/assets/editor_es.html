<!DOCTYPE html>
<html>
<head>
    <script src="./js/ckeditor.js" type="text/javascript" ></script>
    <script type="text/javascript">
        var SC_PAUSED = 10
        var SC_OK     = 200
        var SC_ERROR  = 500
        var editorLoaded = false
        var refreshIntervalId, editor, editorContent

        var editorConfig = {toolbar: [[ 'Bold', 'Italic', '-', 'NumberedList', 'BulletedList', '-'],
            [ 'FontSize', 'TextColor', 'BGColor' ]]}


    // The instanceReady event is fired, when an instance of CKEditor has finished its initialization.
        CKEDITOR.on( 'instanceReady', function( ev ) {
            editorLoaded = true
            if(editorContent != null) {
                setEditorContent(editorContent)
                editorContent = null;
            }
        });

        function setEditorContent(value) {
            if(!editorLoaded) editorContent = value
            else editor.insertHtml( value );
        }

        function submitForm() {
            if(editor.getData().trim().length == 0) {
                 saveForm(SC_ERROR)
            } else {
                clearInterval(refreshIntervalId);
                saveForm(SC_OK)
            }
        }

        function saveForm(statusCode) {
            var webAppMessage = {statusCode:statusCode, message:editor.getData().trim()}
            var message = JSON.stringify(webAppMessage)
            androidClient.setVotingWebAppMessage(message);
            return false
        }

        window.onload = function() {
            refreshIntervalId = setInterval(function(){saveForm(SC_PAUSED)},1000);
            editor = CKEDITOR.appendTo( 'editorDiv', editorConfig);
            editor.resize( '350', '100%', true )
            editor.focus();
        };

    </script>
</head>
<body>
    <div style="position:relative; width:100%;margin:0 0 0 0;">
        <div id='editorDiv' style="height:100%; width:100%;"></div>
    </div>
</body>
</html>